<!DOCTYPE html>
<html lang="id">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Cek Progres Ijazah - Universitas Muhammadiyah Bone</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>
</head>
<body class="bg-gray-100 font-sans">
  <header class="bg-gradient-to-r from-blue-800 to-blue-600 text-white py-6 px-4 shadow-lg">
    <div class="container mx-auto flex flex-col md:flex-row items-center justify-between gap-4">
      <div class="text-center md:text-left flex-1">
        <h1 class="text-3xl font-bold">Sistem Pengecekan Progres Ijazah Mahasiswa</h1>
        <h2 class="text-xl mt-2">Universitas Muhammadiyah Bone</h2>
      </div>
      <div class="flex-shrink-0">
        <img src="https://drive.google.com/uc?export=view&id=1zKh6zQ5m8h2_9tvl_xm3rdiysk0GkC21" alt="Logo Universitas Muhammadiyah Bone" class="h-20 md:h-24">
      </div>
    </div>
  </header>

  <main class="container mx-auto p-4 mt-6">
    <div class="bg-white rounded shadow p-6">
      <label for="nimInput" class="block text-gray-700 text-sm font-semibold mb-2">Masukkan NIM Mahasiswa:</label>
      <input type="text" id="nimInput" placeholder="Contoh: 202301001" class="w-full border border-gray-300 p-2 rounded focus:outline-none focus:ring focus:border-blue-500" />
      <button onclick="cekData()" class="mt-4 bg-blue-600 text-white px-4 py-2 rounded hover:bg-blue-700">Cek Progres</button>
    </div>

    <div id="loading" class="text-center mt-6 hidden">
      <span class="text-blue-600 font-semibold">Mengambil data...</span>
    </div>

    <div id="resultCard" class="bg-white rounded shadow p-6 mt-6 hidden">
      <h3 class="text-lg font-bold mb-2">Hasil Pengecekan:</h3>
      <p><strong>Nama:</strong> <span id="resultNama"></span></p>
      <p><strong>Program Studi:</strong> <span id="resultProdi"></span></p>
      <p><strong>Jenjang:</strong> <span id="resultJenjang"></span></p>
      <p><strong>Tahun Masuk:</strong> <span id="resultTahunMasuk"></span></p>
      <p><strong>Tanggal Yudisium:</strong> <span id="resultTanggalYudisium"></span></p>
      <p><strong>Status:</strong> <span id="resultStatus"></span></p>
      <p><strong>Keterangan:</strong> <span id="resultKeterangan"></span></p>
    </div>

    <div id="noDataMessage" class="mt-6 text-red-600 font-semibold hidden">Data tidak ditemukan.</div>
  </main>

  <script>
    const loadingElement = document.getElementById('loading');
    const resultCard = document.getElementById('resultCard');
    const noDataMessage = document.getElementById('noDataMessage');

    function displayStudentData(student) {
      document.getElementById('resultNama').innerText = student.nama;
      document.getElementById('resultProdi').innerText = student.prodi;
      document.getElementById('resultJenjang').innerText = student.jenjang;
      document.getElementById('resultTahunMasuk').innerText = student.tahun_masuk;
      document.getElementById('resultTanggalYudisium').innerText = student.tanggal_yudisium;
      document.getElementById('resultStatus').innerText = student.status;
      document.getElementById('resultKeterangan').innerText = student.keterangan;

      resultCard.classList.remove('hidden');
    }

    async function cekData() {
      const nim = document.getElementById("nimInput").value.trim();
      if (!nim) return Swal.fire("NIM kosong", "Masukkan NIM terlebih dahulu.", "warning");

      loadingElement.classList.remove('hidden');
      resultCard.classList.add('hidden');
      noDataMessage.classList.add('hidden');

      try {
        const response = await fetch("https://script.google.com/macros/s/AKfycbz8BQMrC5J4F0ni-y8dptdj9ofoTVbJKoo2Or2x6QrsTxodKLlJFVkkbSiEkGXkkTlH/exec");
        const data = await response.json();

        const student = data.find(d => String(d.nim).toUpperCase().trim() === nim.toUpperCase());

        loadingElement.classList.add('hidden');

        if (student) {
          displayStudentData(student);
        } else {
          noDataMessage.classList.remove('hidden');
        }
      } catch (error) {
        loadingElement.classList.add('hidden');
        Swal.fire("Gagal mengambil data", "Periksa koneksi internet atau hubungi admin.", "error");
      }
    }
  </script>
</body>
</html>
